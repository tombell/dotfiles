#!/usr/bin/env bash
set -e

memoir=(
  memoir
  memoir-app
)

stark=(
  skbd
  stark
  swm
)

work=(
  backstage
  contractor
  doorbell
  foundations
  frontdoor
  knock-knock
  ledger
  letterbox
  living
  log-book
  marketing
  neighbourhood
  piggybank
  switchboard
)

start_memoir_sessions() {
  local arr=("$@")

  for c in "${arr[@]}"; do
    cd "$HOME/Code/tombell/$c"
    tmux new-session -d -s "$c" -n "server"
    tmux new-window -t "$c:2" -n "editor"
  done
}

start_stark_sessions() {
  local arr=("$@")

  for c in "${arr[@]}"; do
    cd "$HOME/Code/starkwm/$c"
    tmux new-session -d -s "$c" -n "editor"
  done
}

start_work_sessions() {
  local arr=("$@")

  for c in "${arr[@]}"; do
    cd "$HOME/Code/$c"
    tmux new-session -d -s "$c" -n "server"
    tmux new-window -t "$c:2" -n "editor"
  done
}

main() {
  case ${1:-"work"} in
    memoir)
      start_memoir_sessions "${memoir[@]}"
      ;;
    stark)
      start_stark_sessions "${stark[@]}"
      ;;
    work)
      start_work_sessions "${work[@]}"
      ;;
    *)
      echo "error: unknown environment"
      exit 1
      ;;
  esac
}

main "$1"
